function postToWall(){console.log("Post img to wall");var a,b=canvas.toDataURL("image/png");try{a=dataURItoBlob(b)}catch(c){console.log(c)}FB.login(function(b){if("connected"===b.status){var c=FB.getAuthResponse().accessToken,d=new FormData;d.append("access_token",c),d.append("source",a),d.append("message","Mon dessin sur Pimp My Wall #Baleinev");try{$.ajax({url:"https://graph.facebook.com/me/photos?access_token="+c,type:"POST",data:d,processData:!1,contentType:!1,cache:!1,success:function(a){console.log("success "+a),FB.api("/me",function(a){$.ajax({url:"http://baleinev.ch:8000/facebook",type:"POST",data:a,done:function(a){console.log(a)}})})},error:function(a,b,c){console.log("error "+c+" Status "+a.status)}})}catch(e){console.log(e)}}else console.log("ERROR: getLoginStatus")},{scope:"public_profile,publish_actions,offline_access,user_status,publish_stream,user_photos,photo_upload"}),$("#messageBoxSocial").dialog("close")}function dataURItoBlob(a){for(var b=atob(a.split(",")[1]),c=new ArrayBuffer(b.length),d=new Uint8Array(c),e=0;e<b.length;e++)d[e]=b.charCodeAt(e);return new Blob([c],{type:"image/png"})}window.fbAsyncInit=function(){FB.init({appId:"1381340082121397",cookie:!0,xfbml:!0,version:"v2.0"})},function(a,b,c){var d,e=a.getElementsByTagName(b)[0];a.getElementById(c)||(d=a.createElement(b),d.id=c,d.src="//connect.facebook.net/en_US/sdk.js",e.parentNode.insertBefore(d,e))}(document,"script","facebook-jssdk");